{"version":3,"sources":["webpack:///src/app/verification/verification.page.html","webpack:///src/app/verification/verification.page.scss","webpack:///src/app/verification/verification.module.ts","webpack:///src/app/verification/verification-routing.module.ts","webpack:///src/app/verification/verification.page.ts"],"names":["VerificationPageModule","imports","declarations","routes","path","component","VerificationPageRoutingModule","forChild","exports","VerificationPage","route","router","formBuilder","afs","loadingController","storage","afAuth","alertcontroller","credential","mail","password","phone","state","verificationForm","group","verifiedcode","required","pattern","queryParams","subscribe","params","getCurrentNavigation","extras","data","order","user","info","signin","address","create","cssClass","header","subHeader","message","buttons","alert","present","document","getElementById","style","display","createUserWithEmailAndPassword","email","trim","newUserCredential","doc","uid","set","then","sendEmailVerification","err","msg_networkfailure","remove","alertview","onDidDismiss","error","authState","emailVerified","navigationExtras","navigate","product","selector","template"],"mappings":"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","file":"verification-verification-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons style=\\\"margin-top:5%;\\\" slot=\\\"start\\\">\\n    </ion-buttons>\\n    <ion-title  class=\\\"width\\\" mode=ios >\\n      <ion-text size=\\\"LARGE\\\" color=\\\"warning\\\">\\n        K</ion-text>\\n        <ion-text color=\\\"danger\\\"><ion-icon size=\\\"LARGE\\\" name=cart></ion-icon></ion-text>\\n        <ion-text >ta</ion-text><img title=\\\"app icon\\\" class=\\\"icon\\\" src=\\\"assets/icon/lipstick.png\\\"/><ion-text>og</ion-text>\\n      </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-img id=\\\"img\\\" src=\\\"assets/images/welcome.gif\\\"></ion-img>\\n  \\n    <p id=\\\"mail_link\\\" class=\\\"paragraph\\\">\\n      A verification link was sent to your email adress: {{credential.mail}} please, verify it.\\n    </p>\\n   \\n    \\n   <ion-button class=\\\"center\\\" (click)=\\\"verification()\\\">Start Shopping now</ion-button>   \\n \\n</ion-content>\\n\";","export default \".icon {\\n  width: 15px;\\n  height: 23px;\\n  border: none;\\n  padding: 2px;\\n}\\n\\n.width {\\n  font-size: 26px;\\n}\\n\\n#code {\\n  display: block;\\n  margin: auto;\\n  padding-bottom: 12%;\\n  width: 35%;\\n}\\n\\n.input {\\n  font-size: 14px;\\n  font-weight: bolder;\\n  text-align: center;\\n}\\n\\nsection {\\n  margin-top: 1em;\\n  margin-bottom: 2.5em;\\n}\\n\\nsection:not(.full-width),\\n.full-width > header {\\n  padding: 0 10px;\\n}\\n\\n.paragraph {\\n  display: block;\\n  padding: 20px;\\n  margin: 5px;\\n  font-family: \\\"Gill Sans\\\", \\\"Gill Sans MT\\\", Calibri, \\\"Trebuchet MS\\\", sans-serif;\\n  font-size: 18px;\\n  text-align: justify;\\n}\\n\\n.my-custom-class {\\n  --background: #222;\\n  --spinner-color: #fff;\\n  color: #fff;\\n}\\n\\n.center {\\n  margin-left: 25%;\\n  margin-right: 25%;\\n  padding: auto;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmVyaWZpY2F0aW9uL3ZlcmlmaWNhdGlvbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxXQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7RUFDQSxZQUFBO0FBQ0o7O0FBQ0U7RUFDRSxlQUFBO0FBRUo7O0FBQUU7RUFDRSxjQUFBO0VBQ0EsWUFBQTtFQUNBLG1CQUFBO0VBQ0EsVUFBQTtBQUdKOztBQUFFO0VBQ0UsZUFBQTtFQUNBLG1CQUFBO0VBQ0Esa0JBQUE7QUFHSjs7QUFBRTtFQUNFLGVBQUE7RUFDQSxvQkFBQTtBQUdKOztBQURFOztFQUVFLGVBQUE7QUFJSjs7QUFERTtFQUNFLGNBQUE7RUFDQSxhQUFBO0VBQ0EsV0FBQTtFQUNBLDZFQUFBO0VBQ0EsZUFBQTtFQUNBLG1CQUFBO0FBSUo7O0FBRkU7RUFDRSxrQkFBQTtFQUNBLHFCQUFBO0VBRUEsV0FBQTtBQUlKOztBQUZDO0VBQ0UsZ0JBQUE7RUFDQSxpQkFBQTtFQUNBLGFBQUE7QUFLSCIsImZpbGUiOiJzcmMvYXBwL3ZlcmlmaWNhdGlvbi92ZXJpZmljYXRpb24ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmljb257XG4gICAgd2lkdGg6IDE1cHg7XG4gICAgaGVpZ2h0OiAyM3B4O1xuICAgIGJvcmRlcjogbm9uZTtcbiAgICBwYWRkaW5nOjJweDtcbiAgfVxuICAud2lkdGh7XG4gICAgZm9udC1zaXplOiAyNnB4O1xuICB9XG4gICNjb2Rle1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIG1hcmdpbjogYXV0bztcbiAgICBwYWRkaW5nLWJvdHRvbTogMTIlO1xuICAgIHdpZHRoOiAzNSU7XG4gIH1cblxuICAuaW5wdXR7XG4gICAgZm9udC1zaXplOiAxNHB4O1xuICAgIGZvbnQtd2VpZ2h0OiBib2xkZXI7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyXG4gIH1cblxuICBzZWN0aW9uIHtcbiAgICBtYXJnaW4tdG9wOiAxZW07XG4gICAgbWFyZ2luLWJvdHRvbTogMi41ZW07XG4gIH1cbiAgc2VjdGlvbjpub3QoLmZ1bGwtd2lkdGgpLFxuICAuZnVsbC13aWR0aCA+IGhlYWRlciB7XG4gICAgcGFkZGluZzogMCAxMHB4O1xuICB9XG5cbiAgLnBhcmFncmFwaHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBwYWRkaW5nOiAyMHB4O1xuICAgIG1hcmdpbjogNXB4O1xuICAgIGZvbnQtZmFtaWx5OiAnR2lsbCBTYW5zJywgJ0dpbGwgU2FucyBNVCcsIENhbGlicmksICdUcmVidWNoZXQgTVMnLCBzYW5zLXNlcmlmO1xuICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICB0ZXh0LWFsaWduOiBqdXN0aWZ5O1xuICB9XG4gIC5teS1jdXN0b20tY2xhc3Mge1xuICAgIC0tYmFja2dyb3VuZDogIzIyMjtcbiAgICAtLXNwaW5uZXItY29sb3I6ICNmZmY7XG4gIFxuICAgIGNvbG9yOiAjZmZmO1xuICB9XG4gLmNlbnRlcntcbiAgIG1hcmdpbi1sZWZ0OiAyNSU7XG4gICBtYXJnaW4tcmlnaHQ6IDI1JTtcbiAgIHBhZGRpbmc6IGF1dG87XG4gfSJdfQ== */\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { ReactiveFormsModule} from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { VerificationPageRoutingModule } from './verification-routing.module';\n\nimport { VerificationPage } from './verification.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    VerificationPageRoutingModule,\n    ReactiveFormsModule\n  ],\n  declarations: [VerificationPage]\n})\nexport class VerificationPageModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { VerificationPage } from './verification.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: VerificationPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class VerificationPageRoutingModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, NavigationExtras, Router } from '@angular/router';\nimport { Product } from 'src/models/product';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { AngularFireAuth} from '@angular/fire/auth';\nimport { AlertController, LoadingController } from '@ionic/angular';\nimport { Storage } from '@ionic/storage';\nimport * as firebase from 'firebase';\nimport { User } from 'src/models/user';\nimport { isNullOrUndefined } from 'util';\n\n@Component({\n  selector: 'app-verification',\n  templateUrl: './verification.page.html',\n  styleUrls: ['./verification.page.scss'],\n})\nexport class VerificationPage implements OnInit {\n  data: Product|'';\n  user: User;\n  credential = {\n    mail: '',\n    password: '',\n    phone: ''\n  };\n  \n  phone: string;\n  state = true;\n  constructor(private route: ActivatedRoute, private router: Router, private formBuilder: FormBuilder,\n              private afs: AngularFirestore, public loadingController: LoadingController,\n              private storage: Storage, private afAuth: AngularFireAuth, private alertcontroller: AlertController)\n               {}\n\n  verificationForm = this.formBuilder.group({\n    verifiedcode: ['', [Validators.required, Validators.pattern('^[0-9]{6}(?:-[0-9]{4})?$')]]\n  });\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      if (this.router.getCurrentNavigation().extras.state) {\n        this.data = this.router.getCurrentNavigation().extras.state.order;\n        this.user = this.router.getCurrentNavigation().extras.state.info;\n        this.signin(this.user);\n\n      }\n    });\n  }\n\n  \n\n\n \n async sms_preference(){\n    if(this.user.address.phone!==\"\" && this.user.address.phone!==null){\n      const alert = await this.alertcontroller.create({\n        cssClass: 'my-custom-class',\n            header: 'Alert',\n            subHeader: 'Verification',\n            message: 'Code has been sent to '+this.user.address.phone,\n            buttons: ['Ok']\n      });\n      await alert.present();\n      document.getElementById(\"sms_code\").style.display=\"block\";\n      document.getElementById(\"mail_link\").style.display=\"none;\"\n    }else{\n      const alert = await this.alertcontroller.create({\n        cssClass: 'my-custom-class',\n            header: 'Alert',\n            subHeader: 'Verification',\n            message: 'No phone number found, please verify by email. ',\n            buttons: ['Ok']\n      });\n      await alert.present();\n    }\n    \n    \n\n  }\n  async signin(\n    user: User\n  ): Promise<firebase.auth.UserCredential> {\n    try {\n      const newUserCredential: firebase.auth.UserCredential = await this.afAuth.createUserWithEmailAndPassword(\n        user.email.trim(),\n        user.password.trim()\n      );\n      await this.afs\n        .doc(`user/${newUserCredential.user.uid}`)\n        .set(user).then(async ()=>{this.storage.set(\"user\",user);\n        await newUserCredential.user.sendEmailVerification();\n      }).catch(err=>{newUserCredential.user.delete();this.msg_networkfailure(); this.storage.remove(\"user\");});\n      return newUserCredential;\n      \n    } catch (error) {\n       this.msg_networkfailure();\n    }\n  }\n\n async msg_networkfailure(){\n    const alert = await this.alertcontroller.create({\n      cssClass: 'my-custom-class',\n      header: 'Alert',\n      subHeader: 'Verification',\n      message: 'If your email address is correct please verify your network connection. ',\n      buttons: ['Ok']\n    }).then((alertview)=>{\n       alertview.present();\n       alertview.onDidDismiss().then(()=>{})\n    }).catch(error=>{ throw error});\n  }\n  verification(){\n    this.afAuth.authState.subscribe(user=>{\n      if(user.emailVerified){\n        const navigationExtras: NavigationExtras = {\n          state: {\n            order: this.data\n          }\n        };\n        if (!isNullOrUndefined(this.data)) {\n          this.router.navigate(['/place-order'], navigationExtras);\n        } else {\n          this.router.navigate(['/home']);\n        }\n      }\n    });\n    \n  }\n\n  redirectTo(){\n    if (this.data !== ''){\n      const navigationExtras: NavigationExtras = {\n        state: {\n          product: this.data\n        }\n      };\n      this.router.navigate(['/place-order'], navigationExtras);\n    }else{\n      this.state = false;\n    }\n  }\n\n}\n"]}